<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Spring Advanced(ACE Academy)</title>

		<meta name="description" content="ACE traing of apring advanced topics">
		<meta name="author" content="Havelka Arnošt">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/beige.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', include the PDF print sheet -->
		<script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = 'css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<div class="slides">
							<section>
					<h1>Spring - Advanced</h1>
					<h3>Advanced topics for Spring framework</h3>
					<p>[Internal training by ACE Academy]</p>
					<p>
						<small>Created by <a href="http://cz.linkedin.com/in/arnosthavelka/">Havelka Arnošt</a></small>
					</p>
				</section>

				<section>
					<h2>About me</h2>
					<ol>
						<li>ACE employee: since 6/2009</li>
						<li>Job title: Solution Architect / Head of SW development</li>
						<li>Division: Public CZ</li>
						<li>Certifications:<br/>
							<img src="img/scjp.jpg" alt="Sun Certified Programmer for the Java Platform, Standard Edition 6 (5/2010)">
							<img src="img/ocwsd.gif" alt="Oracle Certified Professional, Java EE 5 Web Services Developer (12/2010)">
							<img src="img/ocjpad.gif" alt="Oracle Certified Expert, Java EE 6 Java Persistence API Developer (5/2014)"><br/>
							<img src="img/spring.jpg" alt="Spring Core 3.0 (7/2013)"><br/>
						</li>
					</ol>
				</section>
				
				<section>
					<h2>Agenda</h2>
					<ol>
						<li>Spring Core - Basics</li>
						<li>Spring Core - Hints</li>
						<li>BFPP & BPP</li>
						<li>Testing</li>
						<li>Spring Boot</li>
						<li>Validation</li>
						<li>Persistence</li>
						<li>AOP</li>
						<li>JMX</li>
						<li>Remoting & WS</li>						
						
					</ol>
				</section>
				
				<section>
					<section>
						<h2>1. Spring Core - Basics</h2>
						<ol>
							<li>Overview</li>
							<li>Inversion of Control</li>
							<li>Spring configuration</li>
							<li>Namespace P and C</li>
							<li>Abstract definition</li>
							<li>SpEL</li>
							<li>Java Specifications (JSR-250, JSR-303 and JSR-330)</li>
						</ol>
					</section>
					<section>
						<h2>1.1 Overview</h2>
						<ul>
							<li><strong>Goal</strong>:Provide comprehensive infrastructural support for developing enterprise Java applications</li>
							<li><strong>Core support</strong>:
								<ul>
									<li>Application Configuration</li>
									<li>Enterprise Configuration</li>
									<li>Testing</li>
									<li>Data Access</li>
								</ul>
							</li>
						</ul>
					</section>
					<section>
						<h2>1.2 Inversion of Control (IoC)</h2>
						<p align="left"><strong>Ioc</strong> is approach that is implemented by design pattern called <a href="http://en.wikipedia.org/wiki/Dependency_injection">Dependency injection</a>. 
						It promotes programmatic to interfaces, improves testability, etc.</p>
						<p>Property (setter) based</p>
						<pre><code class="java">@Service
public class MyService {
    @Autowired
    private MyDao dao;
}</code></pre>
						<p>Constructor based</p>
						<pre><code class="java">@Service
public class MyService {
    private MyDao dao;
    @Autowired
    public MyService(MyDao dao) {
      this.dao = dao;
    }
}</code></pre>
						</section>
					<section>
						<h2>1.3 Spring configuration</h2>
						<p>XML</p>
						<pre><code class="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:p="http://www.springframework.org/schema/p"&gt;
  &lt;context:component-scan base-package="aha.poc" /&gt;
  &lt;bean id="customService" class="somepackage.MyService"/&gt;
&lt;/beans&gt;</code></pre>
						<p>JavaConfig</p>
						<pre><code class="java">@Configuration
@ComponentScan(basePackages = "aha.poc")
@EnableAutoConfiguration
@EnableScheduling
public class Application {

    @Bean
    public MyService customService() {
      return new MyService();
    }
}</code></pre>
					</section>
					<section>
						<h2>1.4 Namespace P and C</h2>
						<p>Namespace P (for properties/setters)</p>
						<pre><code class="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans ... xmlns:p="http://www.springframework.org/schema/p"&gt;
    &lt;context:component-scan base-package="aha.poc" /&gt;
    &lt;bean ... p:msg="Message value" p:dao-ref="myDAO"/&gt;
&lt;/beans&gt;</code></pre>
						<p>Namespace C (for constructors)</p>
						<pre><code class="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans ... xmlns:c="http://www.springframework.org/schema/c"&gt;
    &lt;context:component-scan base-package="aha.poc" /&gt;
    &lt;bean ... c:_0="My Value" c:_1-ref="myDAO"/&gt;
&lt;/beans&gt;</code></pre>
					</section>
					<section>
						<h2>1.5 Abstract definition</h2>
						<pre><code class="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans" ...&gt;

    &lt;bean id="defBean" class="somepackage.AbstractComponent" 
        p:user="sys" p:password="sys" abstract="true"/&gt;
	
    &lt;!-- instantiate bean "defBean" --&gt;
    &lt;bean id="ABean" parent="defBean" p:url="http://host:8080/abc/"/&gt;

    &lt;!-- instantiate and override password" --&gt;
    &lt;bean id="BBean" parent="defBean" p:password="abc" 
        p:url="http://host:8080/abc/" /&gt;

    &lt;!-- instantiate and override user and password --&gt;
    &lt;bean id="CBean" parent="defBean" p:user="admin" 
        p:password="xyz" p:url="http://host:8080/abc/" /&gt;
&lt;/beans&gt;</code></pre>
					</section>
					<section>
						<h2>1.6 SpEL</h2>
						<ul>
							<li>Reference bean
<pre><code class="java">@Value("#{customBean.message}")
private String foo;</code></pre>
							</li>
							<li>Invoking methods, do mathematical, relational and logical operations on values
<pre><code class="java">@Value("#{T(java.lang.Math).random()}")
private Double value;
@Value("#{counter.total+42}")
private Integer value;</code></pre>
							</li>
							<li>Regular expression matching
<pre><code class="java">@Value("#{admin.email matches '[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.com'}")
private String email;</code></pre>
							</li>
							<li>Collection manipulation
<pre><code class="xml">&lt;property name="chosenCity" value="#{cities[2]}" /&gt;</code></pre>
							</li>
						</ul>
					</section>
					<section>
						<h2>1.7 Java Specifications</h2>
						<ol>
							<li><a href="http://en.wikipedia.org/wiki/JSR_250" alt="Link to JSR-250">JSR-250</a> - Semantic concept</li>
							<li><a href="http://en.wikipedia.org/wiki/Bean_Validation" alt="Link to JSR-303">JSR-303</a> - Bean Validation</li>
							<li><a href="https://jcp.org/en/jsr/detail?id=330" alt="Link to JSR-330">JSR-330</a> - Dependency Injection for Java</li>
						</ol>
					</section>
					<section>
						<h2>1.7.1 JSR-250 - Semantic concept [1/2]</h2>
						<p align="left"><a href="http://en.wikipedia.org/wiki/JSR_250" alt="Link to JSR-250">JSR-250</a> is a specification of annotations for common 
						semantic concepts in the Java SE and Java EE platforms that apply across a variety of individual technologies.</p>
						<table style="border: 1px solid gray;">
							<tr style="background-color: gray;">
								<th>Annotation</th>
								<th>Description</th>
							</tr>
							<tr>
								<td>@Generated</td>
								<td>Marks sources that have been generated</td>
							</tr>
							<tr>
								<td>@Resource</td>
								<td>Declares a reference to a resource (e.g. from JNDI, servlet context, etc.)</td>
							</tr>
							<tr>
								<td>@PostConstruct</td>
								<td>Do initialization</td>
							</tr>
							<tr>
								<td>@PreDestroy</td>
								<td>Do finalization</td>
							</tr>
							<tr>
								<td>@RolesAllowed</td>
								<td>Specifies the security roles permitted to access method(s) in an application</td>
							</tr>
						</table>
					</section>
					<section>
						<h2>1.7.1 JSR-250 - Semantic concept [2/2]</h2>
						<p align="left">Definition:</p>
						<pre><code class="xml">&lt;context:annotation-config/&gt; &lt;!-- process DI, JSR-250, etc. --&gt;
&lt;context:component-scan/&gt;    &lt;!-- same as annotation-config + scan packages to register beans --&gt;</code></pre>
						<p align="left">Usage:</p>
						<pre><code class="java">@Component
public class MyService {
    @Resource
    private MyDao dao;
  
    @Value("${my_message}")
    private String msg;
  
    @PostConstruct
    private void init() {
      msg = "N/A";
  }
}</code></pre>
					</section>
					<section>
						<h2>1.7.2 JSR-303 - Bean Validation [1/2]</h2>
						<p align="left"><a href="http://en.wikipedia.org/wiki/Bean_Validation">Bean Validation</a> (JSR-303 for version 1.0 + JSR-349 for version 1.1) 
						defines a metadata model and API for JavaBean validation. The metadata source is annotations, with the ability to override and extend the meta-data 
						through the use of XML validation descriptors.</p>
					</section>
					<section>
						<h2>1.7.2 JSR-303 - Bean Validation [2/2]</h2>
						<p align="left">Validator definition:</p>
						<pre><code class="xml">&lt;bean id="val" class="o.s.v.beanvalidation.LocalValidatorFactoryBean" /&gt;</code></pre>
						<p align="left">DTO definition:</p>
						<pre><code class="java">public class AuditForm {
    @NotNull
    private Integer id;
    @Past(message = "{basicValidationErrorNotPast}")
    private Date platnostOd;
    @Size(max = 10, message = "Username length exceeded!")
    private String username;
}</code></pre>
						<small>Resources are located in <i>${project}\src\main\resources\ValidationMessages.properties.</i></small>
						<p align="left">Usage:</p>
						<pre><code class="java">@Autowired
private Validator validator;

private &lt;D&gt; List&lt;String&gt; process(D dto) {
    Set&lt;ConstraintViolation&lt;D&gt;&gt; validationResult = validator.validate(dto);
    ...
}</code></pre>
					</section>
					<section>
						<h2>1.7.3 JSR-330 - Dependency Injection for Java [1/2]</h2>
						<p align="left"><a href="http://jcp.org/en/jsr/detail?id=330">JSR-330</a> is specification of Dependency Injection in java world. It was introduced in JavaEE 6 and supported from Spring 3.0.</p>
						<pre><code class="xml">&lt;dependency&gt;
    &lt;groupId&gt;javax.inject&lt;/groupId&gt;
    &lt;artifactId&gt;javax.inject&lt;/artifactId&gt;
    &lt;version&gt;1&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
						<p align="left">Usage:
							<ul>
								<li><b>@Inject</b> instead of Spring’s <b>@Autowired</b> to inject a bean (@Inject has 80% of @Autowired).</li>
								<li><b>@Named</b> instead of Spring’s <b>@Component</b> to declare a bean.</li>
							</ul>	
						</p>
					</section>
					<section>
						<h2>1.7.3 JSR-330 - Dependency Injection for Java [2/2]</h2>
						<table style="border: 1px solid gray;">
							<tr style="background-color: gray;">
							  <th>Spring</th>
							  <th>javax.inject.*</th>
							  <th>Description</th>
							</tr>
							<tr>
							  <td>@Autowired</td>
							  <td>@Inject</td>
							  <td>@Inject has no 'require' attribute</td>
							</tr>
							<tr>
							  <td>@Component</td>
							  <td>@Named</td>
							  <td>JSR-330 has default scope <b>prototype</b></td>
							</tr>
							<tr>
							  <td>@Scope("singleton")</td>
							  <td>@Singleton</td>
							  <td>&nbsp;</td>
							</tr>
							<tr>
							  <td>@Qualifier</td>
							  <td>@Named</td>
							  <td>&nbsp;</td>
							</tr>
							<tr>
							  <td>@Value, @Required, @Lazy</td>
							  <td>no equivalent</td>
							  <td>@Inject has no 'require' attribute</td>
							</tr>
						</table>	  						
					</section>
				</section>
				
				<section>
					<section>
						<h2>2. Spring Core - Hints</h2>
						<ol>
							<li>Application configuration</li>
							<li>Profiles</li>
							<li>Proxy for scope</li>
							<li>Classpath scanning</li>
							<li>Component scan & bean with no-arg constructor</li>
						</ol>
					</section>
					<section>
						<h2>2.1 Application configuration</h2>
						<ol>
							<li><strong>Place holder</strong> - to manage configuration properties (placeholders)</li>
							<li><strong>Place override</strong> - to override bean's properties</li>
						</ol>
					</section>			
					<section>
						<h2>2.1.1 Place holder</h2>
<pre><code class="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans" ...&gt;

  &lt;context:property-placeholder location="classpath:db-${my.env}.properties" 
      properties-ref="defaultConfig" ignore-resource-not-found="true" /&gt;
	
  &lt;util:map id="defaultConfig"&gt;
    &lt;entry key="mySecretValue" value="7"/&gt;
  &lt;/util:map&gt;
&lt;/beans&gt;</code></pre>
					</section>
					<section>
						<h2>2.1.2 Place override</h2>
						<p align="left">Bean definition:</p>
						<pre><code class="java">@Component
public class CustomBean {
    @Value("${some-config-item}")
    private String message = "default message";
}</code></pre>
						<p align="left">Define overridden rule:</p>
						<pre><code>customBean.message=custom message</code></pre>
						<p align="left">Load place-override definition (rules):</p>
						<pre><code class="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans" ...&gt;

  &lt;context:property-override location="classpath:override.properties"/&gt;

&lt;/beans&gt;</code></pre>					</section>
					
					<section>
						<h2>2.2 Profiles</h2>
						<ol>
							<li>Overview</li>
							<li>XML Configuration</li>
							<li>Annotation Configuration</li>
							<li>Custom annotation (for configuration)</li>
							<li>Example of usage</li>
						</ol>
					</section>
					<section>
						<h2>2.2.1 Overview</h2>
						<p align="left">The profile definition allows Spring bean only for some context (in some situation). E.g. to distinguish between environment, 
						code life-cycle (runtime, test, etc.).</p>
						<p align="left">Activation by Java (system property):</p>
						<pre><code class="java">System.setProperty("spring.profiles.active", "dev");
System.setProperty("spring.profiles.default", "local");</code></pre>
						<p align="left">Activation by Java (annotation):</p>
						<pre><code class="java">@ActiveProfiles("dev")</code></pre>
						<p align="left">Activation by JVM parameter (e.g. through maven):</p>
						<pre><code>-Dspring.profiles.active="dev"</code></pre>
						<p align="left">Activation by configuration (i.e. setting a property value):</p>
						<pre><code class="java">spring.profiles.active=dev</code></pre>
					</section>
					<section>
						<h2>2.2.2 XML Configuration</h2>
						<pre><code class="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans" ...&gt;
    &lt;beans&gt;
        &lt;import resource="classpath:/META-INF/spring/app-context-base.xml"/&gt;
    &lt;/beans&gt;
    &lt;beans profile="dev"&gt;
        &lt;import resource="classpath:/META-INF/spring/app-context-dev.xml"/&gt;
    &lt;/beans&gt;
    &lt;beans profile="prod"&gt;
        &lt;import resource="classpath:/META-INF/spring/app-context-prod.xml"/&gt;
    &lt;/beans&gt;
&lt;/beans&gt;</code></pre>
					</section>
					<section>
						<h2>2.2.3 Annotation Configuration</h2>
						<p align="left">Profile scope definition:</p>
						<pre><code class="java">@Component
@Profile("dev")
public class UserDAOImpl implements UserDAO {
}	

@Component
@Profile("prod")
public class UserDAOImpl implements UserDAO {
}</code></pre>
						<p align="left">Profile activation:</p>
						<pre><code class="java">@ContextConfiguration
@RunWith(SpringJUnit4ClassRunner.class)
@ActiveProfiles("dev")
public class UserServiceDaoTest {

	@Autowired
	private UserDAO dao;

}</code></pre>
					</section>
					<section>
						<h2>2.2.4 Custom annotation</h2>
						<h3>(for configuration)</h3>
						<p align="left">Definition of profile annotation:</p>
						<pre><code class="java">@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Profile("test")
public @interface Mock {
}</code></pre>
						<p align="left">Usage:</p>
						<pre><code class="java">@Component
@Mock
public class UserDAOMock implements UserDAO {
	...
}</code></pre>
					</section>
					<section>
						<h2>2.2.5 Example of usage</h2>
						<pre><code class="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans" ...&gt;

    &lt;bean profile="dev"&gt;
        &lt;jdbc:embedded-database id="dataSource"&gt;
            &lt;jdbc:script location="classpath:com/bank/config/sql/schema.sql"/&gt;
            &lt;jdbc:script location="classpath:com/bank/config/sql/test-data.sql"/&gt;
        &lt;/jdbc:embedded-database&gt;
    &lt;/bean&gt;

    &lt;bean profile="prod"&gt;
        &lt;jee:jndi-lookup id="dataSource" jndi-name="java:comp/env/jdbc/datasource"/&gt;
    &lt;/bean&gt;

&lt;/beans&gt;</code></pre>
					</section>				
					
					<section>
						<h2>2.3 Proxy for scope</h2>
						<p>
							<ol>
								<li>Overview</li>
								<li>XML Configuration</li>
								<li>Annotation Configuration</li>
							</ol>
						</p>
						<small>Source: <a href="http://stackoverflow.com/questions/4503606/annotation-equivalent-of-aopscoped-proxy" alt="Source link">http://stackoverflow.com/questions/4503606/annotation-equivalent-of-aopscoped-proxy</a></small>
					</section>
					<section>
						<h2>2.3.1 Overview</h2>
						<ul>
							<li>Proxy purpose - handle beans lifecycle correctly</li>
							<li>Scopes:
								<ul>
									<li><strong>Singleton</strong> (default) -  just one instance</li>
									<li><strong>Prototype</strong> - always new instance</li>
									<li><strong>Request</strong> (for web) - an instance per HTTP request</li>
									<li><strong>Session</strong> (for web) - an instance per HTTP session</li>
									<li><strong>Flow</strong> (for Spring WebFlow) or <strong>Step</strong> (for Spring Batch) - special Spring scopes</li>
									<li><strong>Custom</strong> (to be implemented) - an instance per custom rule</li>
								</ul>
							</li>
						</ul>

					</section>
					<section>
						<h2>2.3.2 XML Configuration</h2>
						<p>Single bean:</p>
						<pre><code class="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans" ...&gt;

    &lt;bean id="wsService" p:service-ref="sessinService" /&gt;

    &lt;bean id="sessinService" scope="session"&gt;
        &lt;aop:scoped-proxy/&gt;
    &lt;/bean&gt;

&lt;/beans&gt;</code></pre>
						<p>All beans:</p>
						<pre><code class="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans" ...&gt;

  &lt;context:component-scan base-package="x.y.z" scoped-proxy="interfaces¦target_class" /&gt;

&lt;/beans&gt;</code></pre>
					</section>
					<section>
						<h2>2.3.3 Annotation Configuration</h2>
						<pre><code class="java">@Component
public class WsService {
  @Autowire
  private MyService service;
}

@Component
@Scope(value = "prototype", proxyMode = ScopedProxyMode.INTERFACES)
public class PrivateService implement MyService {
  ...
}</code></pre>
						<small>Example: <a href="https://github.com/arnosthavelka/spring-advanced-training/blob/master/sat-core/src/main/java/com/asseco/aha/training/spring_advanced/core/scope/ScopeApplication.java" alt="Example of proxy mode">ScopeApplication.java</a></small>
					</section>
					<section>
						<h2>2.4 Classpath scanning</h2>
						<p align="left"><strong>Use case</strong>: find some classes (in classpath) based on some criteria.</p>
						<p align="left"><strong>Solution</strong>: use <i>ClassPathScanningCandidateComponentProvider</i>.</p>
						<pre><code class="java">ClassPathScanningCandidateComponentProvider provider = new ClassPathScanningCandidateComponentProvider(false);
// Filter to include only classes that have a particular annotation.
provider.addIncludeFilter(new AnnotationTypeFilter(MyAnnotation.class));
// Find classes in the given package (or subpackages)
Set&lt;BeanDefinition&gt; beans = provider.findCandidateComponents("com.xyz.abc");
for (BeanDefinition bd : beans) {
  // The BeanDefinition class gives access to the Class&lt;?&gt; and other attributes.
}</code></pre>
						<ul>Filters
							<li>AnnotationTypeFilter -  based on annotations (on the class)</li>
							<li>AssignableTypeFilter - based on superclass or interface</li>
							<li>RegexPatternTypeFilter - based on a fully qualified class name against a regular expression.</li>
						</ul>
						<small>Source: <a href="http://www.eclecticlogic.com/2014/09/01/classpath-scanning/" alt="Source link">http://www.eclecticlogic.com/2014/09/01/classpath-scanning/</a></small>
					</section>
					<section>
						<h2>2.5 Component scan with no no-args constructor bean</h2>
						<p>
							<ol>
								<li>Overview</li>
								<li>Solution</li>
								<li>Conclusion</li>
							</ol>
						</p>
						<small>Source: <a href="http://java.dzone.com/articles/spring-component-scan-beans-no" alt="Source link">http://java.dzone.com/articles/spring-component-scan-beans-no</a></small>
					</section>
					<section>
						<h2>2.5.1 Overview</h2>
						<pre>Bean definition:<code class="java">@Component
public class User {

    public User(String name) {
        ...
    }
}</code></pre>
						<pre>Bean usage:<code class="java">@Bean
public User userArny() {
    return new User("Arny");
}</code></pre>
						<pre>Spring error:<code>Caused by: o.s.b.BeanInstantiationException: Could not instantiate bean 
    class [com...config.User]: No default constructor found; 
        nested exception is java.lang.NoSuchMethodException: com.asseco.aha.training.spring_advanced.core.config.User.&lt;init&gt;()
	    at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:85) ~[spring-beans-4.0.8.RELEASE.jar:4.0.8.RELEASE]
	    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1070) ~[spring-beans-4.0.8.RELEASE.jar:4.0.8.RELEASE]
	    ... 16 common frames omitted
</code></pre>
					</section>
					<section>
						<h2>2.5.2 Solution [1/4]</h2>
						<h4>Variant 1</h4>
						<p align="left">Modify bean definition for autowiring with default values (annotations @Autowired and @Value).</p>
						<pre>Spring Bean<code class="java">@Component
public class User {

    @Autowired
    public User(@Value("") String name) {
        ...
    }
}</code></pre>
						<small>Example: <a href="https://github.com/arnosthavelka/spring-advanced-training/blob/master/sat-core/src/main/java/com/asseco/aha/training/spring_advanced/core/config/JavaConfigApplication.java" alt="Example of proxy mode">JavaConfigApplication.java</a></small>
					</section>
					<section>
						<h2>2.5.2 Solution [2/4]</h2>
						<h4>Variant 2</h4>
						<p align="left">Just not define POJO as Spring Bean. It will be marked as bean by JavaConfig.</p>
						<pre><code class="java">public class User {

    public User(String name) {
        ...
    }
}</code></pre>
					</section>
					<section>
						<h2>2.5.2 Solution [3/4]</h2>
						<h4>Variant 3</h4>
						<p align="left">Remove component scan from JavaConfig.</p>
						<pre><code class="java">@Configuration
@EnableAutoConfiguration
public class JavaConfigApplication {
    ...
}</code></pre>
					</section>
					<section>
						<h2>2.5.2 Solution [4/4]</h2>
						<h4>Variant 4</h4>
						<p align="left">Use excludes in component scan.</p>
						<pre><code class="java">@Configuration
@ComponentScan(basePackages = { "com.asseco.aha.training.spring_advanced.core.config" }, 
    excludeFilters = @ComponentScan.Filter(
        type = FilterType.ANNOTATION, 
        value = Component.class))
@EnableAutoConfiguration
public class JavaConfigApplication {
    ...
}</code></pre>
					</section>
					<section>
						<h2>2.5.3 Conclusion</h2>
						<ul>
							<li>If component scanning is enabled, spring will try to create a bean even though a bean of that class has already been defined in the spring config xml.</li>
							<li>However if the bean defined in the spring config file and the auto-discovered bean have the same name, spring will not to create a new bean while it does component scanning.</li>
							<li>If a bean does not have a no-args constructor, at-least one of the constructors must be auto-wired.</li>
							<li>If no constructor is auto-wired, spring will try to create an object using default no-args constructor.</li>
						</ul>
					</section>
				</section>

				<section>
					<section>
						<h2>3. BFPP & BPP</h2>
						<ol>
							<li>Spring life-cycle</li>
							<li>Factory bean</li>
							<li>BFPP</li>
							<li>BPP</li>
						</ol>
					</section>
					<section>
						<h2>3.1 Spring life-cycle</h2>
						<ol>
							<li>Schema</li>
							<li>Bean initialization order</li>
							<li>Bean disposal order</li>
						</ol>
					</section>
					<section>
						<h2>3.1.1 Spring Life-cycle Schema</h2>
						<svg style="width:100%; height:450px;">
							<text x="280" y="30">Definition of application context</text>
							<line x1="470" y1="35" x2="470" y2="80" stroke="#000000" stroke-width="2"/>
							<line x1="460" y1="70" x2="470" y2="80" stroke="#000000" stroke-width="2"/>
							<line x1="480" y1="70" x2="470" y2="80" stroke="#000000" stroke-width="2"/>
							<text x="480" y="65" fill="blue">1</text>
							
							<text x="130" y="130">BFPP</text>
							<line x1="220" y1="120" x2="360" y2="120" stroke="#000000" stroke-width="2"/>
							<line x1="350" y1="110" x2="360" y2="120" stroke="#000000" stroke-width="2"/>
							<line x1="350" y1="130" x2="360" y2="120" stroke="#000000" stroke-width="2"/>
							<text x="280" y="115" fill="blue">2</text>
										
							<rect x="360" y="80" width="280" height="80" stroke="#000000"	stroke-width="4" fill="#AAAAFF" />
							<text x="380" y="130">Bean Definition</text>
							
							<line x1="470" y1="160" x2="470" y2="250" stroke="#000000" stroke-width="2"/>
							<line x1="460" y1="240" x2="470" y2="250" stroke="#000000" stroke-width="2"/>
							<line x1="480" y1="240" x2="470" y2="250" stroke="#000000" stroke-width="2"/>
							<text x="480" y="210" fill="blue">3</text>
							
							<text x="130" y="300">BPP</text>
							<line x1="220" y1="290" x2="360" y2="290" stroke="#000000" stroke-width="2"/>
							<line x1="350" y1="280" x2="360" y2="290" stroke="#000000" stroke-width="2"/>
							<line x1="350" y1="300" x2="360" y2="290" stroke="#000000" stroke-width="2"/>
							<text x="280" y="285" fill="blue">4</text>

							<rect x="360" y="250" width="280" height="80" stroke="#000000"	stroke-width="4" fill="#AAAAFF" />
							<text x="420" y="300">Instance</text>
							
							<line x1="470" y1="330" x2="470" y2="380" stroke="#000000" stroke-width="2"/>
							<line x1="460" y1="370" x2="470" y2="380" stroke="#000000" stroke-width="2"/>
							<line x1="480" y1="370" x2="470" y2="380" stroke="#000000" stroke-width="2"/>
							<text x="480" y="370" fill="blue">5</text>
							
							<text x="440" y="410">Ready</text>
						</svg>
					</section>
					<section>
						<h2>3.1.2 Bean Initialization Order</h2>
						<ul>
							<li>[1] Load all bean defintions to create ordered graph</li>
							<li>[2] Instantiate and run BeanFactoryPostProcessors</li>
							<li>[3] Instantiate each bean</li>
							<li>[3] Set bean's properties</li>
							<li>[4] <a href="http://www.tutorialspoint.com/spring/spring_bean_post_processors.htm">BeanPostProcessor</a> (for all beans) - postProcessBeforeInitialization</li>
							<li>[4] @PostConstruct (for bean instance)</li>
							<li>[4] <a href="http://www.mkyong.com/spring/spring-initializingbean-and-disposablebean-example/">InitializingBean</a> (for bean instance) - afterPropertiesSet</li>
							<li>[4] XML (for bean instance) - init-method</li>
							<li>[4] <a href="http://www.tutorialspoint.com/spring/spring_bean_post_processors.htm">BeanPostProcessor</a> (for all beans) - postProcessAfterInitialization</li>
						</ul>
					</section>
					<section>
						<h2>3.1.3 Bean Disposal Order</h2>
						<ul>
							<li>@PreDestroy (for bean instance)</li>
							<li><a href="http://www.mkyong.com/spring/spring-initializingbean-and-disposablebean-example/">DisposableBean</a> (for bean instance) - destroy</li>
							<li>XML (for bean instance) - destroy-method</li>
						</ul>
					</section>
					<section>
						<h2>3.2 Factory bean</h2>
						<ol>
							<li>Factory Methods
								<ul>
									<li>Simple usage for static methods (the old singletons)</li>
								</ul>
							</li>
							<li>POJOs as Factory Beans
								<ul>
									<li>Simple usage</li>
								</ul>
							</li>
							<li>The FactoryBean Interface
								<ul>
									<li>Spring uses (such approach) for looking up JNDI objects, creating remote proxies, configuring data access (e.g. Hibernate, JPA, etc.).</li>
									<li>Beans with FactoryBean interface are detected automatically.</li>
								</ul>
							</li>
						</ol>
					</section>
					<section>
						<h2>3.2.1 Factory Methods</h2>
						<p align="left">Class definition:</p>
						<pre><code class="java">public class OldSingleton {
						
  private static OldSingleton singleton = new OldSingleton();
  private OldSingleton() {...}
  
  public OldSingleton getInstance() {
	return singleton;
  }
}
</code></pre>
						<p align="left">Spring definition:</p>
						<pre><code class="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans" ...&gt;

  &lt;bean id="foo" class="abc.OldSingleton" factory-method="getInstance" /&gt;

&lt;/beans&gt;</code></pre>
					</section>
					<section>
						<h2>3.2.2 POJOs as Factory Beans</h2>
						<p align="left">POJO definition:</p>
						<pre><code class="java">public class PojoFactory {
						
  public MyService getInstance() {...}

}</code></pre>
						<p align="left">Spring definition:</p>
						<pre><code class="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans" ...&gt;

  &lt;bean id="pojoFactory" class="abc.PojoFactory" /&gt;
  
  &lt;bean id="myService" factory-bean="pojoFactory" factory-method="getInstance" /&gt;

&lt;/beans&gt;</code></pre>
					</section>
					<section>
						<h2>3.2.3 Factory Bean</h2>
						<p align="left">FactoryBean implementation:</p>
						<pre><code class="java">public class MyFactoryBean implements FactoryBean&lt;MyService&gt; {
  // ... instantiate ClientService class as clientService...
  
  public MyService getObject() throws Exception { return clientService; }
  public Class&lt;?&gt; getObjectType() { return ClientService.class }
  public MyService isSingleton() throws Exception { return true ¦ false; }

}</code></pre>
						<p align="left">Spring definition:</p>
						<pre><code class="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans" ...&gt;

  &lt;bean id="myFB" class="abc.MyFactoryBean" /&gt;
  
  &lt;bean id="myService" p:service-ref="myFB" /&gt;

&lt;/beans&gt;</code></pre>
					</section>
					<section>
						<h2>3.3 BFPP - overview [1/2]</h2>
						<ol>
							<li>Called after bean definition is loaded, but before bean is instantiated.</li>
							<li>Useful for applying modifications on some beans or groups of beans.</li>
							<li>Just implement interface <i>BeanFactoryPostProcessor</i></li>
							<li>Example: <i>PropertyPlaceholderConfigurer</i></li>
						</ol>
					</section>
					<section>
						<h2>3.3 BFPP - usage [2/2]</h2>
						<p align="left">BFPP implementation:</p>
						<pre><code class="java">public class MyBfpp implements BeanFactoryPostProcessor {
  public void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) throws BeansException {
    String[] beanNames = beanFactory.getBeanDefinitionNames();
	...
  }
}</code></pre>
						<p align="left">Spring definition:</p>
						<pre><code class="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans" ...&gt;

  &lt;bean id="myBfpp" class="abc.MyBfpp" /&gt;

&lt;/beans&gt;</code></pre>
						<small>Example: <a href="https://github.com/arnosthavelka/spring-advanced-training/blob/master/sat-core/src/main/java/com/asseco/aha/training/spring_advanced/core/postprocessor/PostProcessorApplication.java" alt="Example of proxy mode">PostProcessorApplication.java</a></small>
					</section>
					<section>
						<h2>3.4 BPP - overview [1/2]</h2>
						<ol>
							<li>Can modify bean instance in any way.</li>
							<li>Just implement interface <i>BeanPostProcessor</i></li>
							<li>Example: <i>BeanValidationPostProcessor</i> (for JSR-303), <i>CommonAnnotationBeanPostProcessor</i> (for JSR-250), <i>RequiredAnnotationBeanPostProcessor</i>, etc.</li>
						</ol>
					</section>
					<section>
						<h2>3.4 BPP - usage [2/2]</h2>
						<p align="left">BPP implementation:</p>
						<pre><code class="java">public class MyBpp implements BeanPostProcessor {
  @Override
  public Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException {
    ...
  }

  @Override
  public Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {
    ...
  }
}</code></pre>
						<p align="left">Spring definition:</p>
						<pre><code class="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans" ...&gt;

  &lt;bean id="myBpp" class="abc.MyBpp" /&gt;

&lt;/beans&gt;</code></pre>
						<small>Example: <a href="https://github.com/arnosthavelka/spring-advanced-training/blob/master/sat-core/src/main/java/com/asseco/aha/training/spring_advanced/core/postprocessor/PostProcessorApplication.java" alt="Example of proxy mode">PostProcessorApplication.java</a></small>
					</section>					
				</section>

				<section>
					<section>
						<h2>4. Testing</h2>
						<p style="color:red">TODO</p>
						<ol>
							<li>Overview</li>
							<li>Spring configuration for testing</li>
							<li>Usage of profiles (@ActiveProfiles, @IfProfileValue)</li>
							<li>Special annotations (@Timed, @Repeat)</li>
							<li>Springockito - https://bitbucket.org/kubek2k/springockito/wiki/Home + Milanuv mail</li>
						</ol>
						<small>See: my presentation of <a href="http://arnosthavelka.github.com/presentation/devday/automated_testing/template.html" alt="Link to presentation of automated testing">automated testing</a></small>
					</section>
					<section>
						<h2>4.1 Overview</h2>
						<ol>
							<li>Test Types & Approaches</li>
							<li>Test Levels</li>
							<li>Mocks & Stubs</li>
							<li>Rules for writting tests</li>
							<li>Unit tests</li>
						</ol>
					</section>
					<section>
						<h2>4.1.1 Test Types & Approaches</h2>
						<ol>
							<li>Types:
								<ul>
									<li>Static (reviews, inspection, etc.)</li>
									<li>Dynamic (execution of program againt test case)</li>
								</ul>
							</li>
							<li>Approaches:
								<ul>
									<li>Black box (examining functionality without any knowledge of internal implementation)</li>
									<li>White box(tests internal structures or workings of a program)</li>
									<li>Gray box (executing tests at the user, or black-box level, with having knowledge of internal data structures and algorithms for purposes of designing tests)</li>
								</ul>
							</li>
						</ol>
					</section>
					<section>
						<h2>4.1.2 Test Levels</h2>
						<ul>
							<li>Unit (component testing)</li>
							<li>Integration (testing interfaces between components against a software design)</li>
							<li>System(tests a completely integrated system to verify that it meets its requirement)</li>
							<li>Acceptance (UAT)</li>
						</ul>
					</section>
					<section>
						<h2>4.1.3 Mocks & Stubs</h2>
						<table style="border: 1px solid gray;">
							<tr style="background-color: gray;">
								<th></th>
								<th>Advantages</th>
								<th>Disadvantages</th>
							</tr>
							<tr>
								<th style="border-top: 1px solid gray; background-color: silver;">Mock</th>
								<td style="border-top: 1px solid gray;">
									<ol>
										<li>No additional class to maintain</li>
										<li>Only relevant for the test</li>
										<li>Test behavior and state</li>
									</ol>
								</td>
								<td style="border-top: 1px solid gray;">
									<ol>
										<li>A little harder to understand (at first)</li>
									</ol>
								</td>
							</tr>
							<tr>
								<th style="border-top: 1px solid gray; background-color: silver;">Stub</th>
								<td style="border-top: 1px solid gray;">
									<ol>
										<li>Easy to implement and understand</li>
										<li>Reusable</li>
									</ol>
								</td>
								<td style="border-top: 1px solid gray;">
									<ol>
										<li>Needs update when the interface is changed</li>
										<li>Must implement all methods</li>
										<li>Refactoring can break other test (where the stub is reused)</li>
									</ol>
								</td>
							</tr>
						</table>
					</section>
					<section>
						<h2>4.1.4 Rules for writting tests</h2>
						<ul>
							<li>Independency</li>
							<li>Performance</li>
							<li>Only in test package</li>
							<li>High test coverage != good tests</li>
						</ul>
					</section>
					<section>
						<h2>4.1.5 Unit tests</h2>
						<ul>
							<li>Usage of JUnit</li>
							<li>Mocking - EasyMock + Mockito + PowerMock</li>
							<li>Hamcrest - clearer syntax/declarations and customized assertion matchers</li>
						</ul>
					</section>
					
					<section>
						<h2>4.2 Spring configuration for testing</h2>
						<ol>
							<li>Spring way</li>
							<li>Spring Boot way (XML)</li>
							<li>Spring Boot way (JavaConfig)</li>
						</ol>
					</section>
					<section>
						<h2>4.2.1 Spring way (XML)</h2>
						<h4>Default XML location</h4>
						<p align="left">Configuration:</p>
						<pre><code class="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans" ...&gt;

  &lt;bean id="user" class="com...core.config.User" c:name="Michel"/&gt;

&lt;/beans&gt;</code></pre>
						<p align="left">Usage:</p>
						<pre><code class="java">// path is com/asseco/aha/training/spring_advanced/core/config/XmlDefaultConfigTest-context.xml
@ContextConfiguration
@RunWith(SpringJUnit4ClassRunner.class)
public class XmlDefaultConfigTest {
    ...
}</code></pre>
					</section>
					<section>
						<h2>4.2.2 Spring way (XML)</h2>
						<h4>Define XML location</h4>
						<p align="left">Configuration:</p>
						<pre><code class="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans" ...&gt;

  &lt;bean id="user" class="com...core.config.User" c:name="Arny"/&gt;

&lt;/beans&gt;</code></pre>
						<p align="left">Usage:</p>
						<pre><code class="java">@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = "classpath:spring/xml-config.xml")
public class XmlDirectConfigTest {
    ...
}</code></pre>
					</section>
					<section>
						<h2>4.2.3 Spring Boot way (JavaConfig)</h2>
						<p align="left">Configuration:</p>
						<pre><code class="Java">@Configuration
@ComponentScan("com.asseco.aha.training.spring_advanced.core.config")
@EnableAutoConfiguration
public class JavaConfigApplication {
    ...
}</code></pre>
						<p align="left">Usage:</p>
						<pre><code class="java">@RunWith(SpringJUnit4ClassRunner.class)
@SpringApplicationConfiguration(classes = JavaConfigApplication.class)
public class JavaConfigTest {
    ...
}</code></pre>
					</section>

					<section>
						<h2>4.3 Usage of profiles (@ActiveProfiles, @IfProfileValue)</h2>
						<ol>
							<li>Profile Definition</li>
							<li>@ActiveProfiles</li>
							<li>@IfProfileValue</li>
						</ol>
					</section>
					<section>
						<h2>4.3.1 Profile Definition</h2>
						<p align="left">XML:</p>
						<pre><code class="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans" ...&gt;

    &lt;beans profile="richard"&gt;
        &lt;bean id="userRichard" c:name="Richard" class="com...core.config.User" /&gt;
    &lt;/beans&gt;
  
&lt;/beans&gt;</code></pre>
						<p align="left">JavaConfig:</p>
						<pre><code class="java">@Configuration
@Profile("richard")
public class RichardConfig {

    @Bean
    public User userArny() {
        return new User("Richard");
    }

}</code></pre>
					</section>					
					<section>
						<h2>4.3.2 @ActiveProfiles</h2>
						<pre><code class="java">@RunWith(SpringJUnit4ClassRunner.class)
@SpringApplicationConfiguration(
    classes = { MyConfig.class, RichardConfig.class, BarbaraConfig.class })
@ActiveProfiles("richard")
public class RichardConfigTest {

    @Test
    public void testHello() {
        assertThat(user.getName(), equalTo("Richard"));
    }
}
</code></pre>
					</section>
					<section>
						<h2>4.3.3 @IfProfileValue</h2>
						<p align="left">Define test with <i>@IfProfileValue</i> annotation.</p>
						<pre><code class="java">@RunWith(SpringJUnit4ClassRunner.class)
@SpringApplicationConfiguration(classes = { MyConfig.class, BarbaraConfig.class })
@ActiveProfiles("richard")
public class RichardConfigTest {

    @Test
    @IfProfileValue(name = "test-group", values = { "training" })
    public void testHello() {
        assertThat(user.getName(), not(equalTo("Arny")));
    }
}
</code></pre>
						<p align="left">Use profile by calling JVM with e.g. <i>-Dtest-group=training</i>. Annotation reflects JVM parameters, environments properties, etc.</p>
					</section>
				</section>

				<section>
					<section>
						<h2>5. Spring Boot</h2>
						<p style="color:red">TODO</p>
						<ol>
							<li>Overview</li>
							<li>REST simple example</li>
							<li>Externalize configuration with Spring Boot</li>
							<li>Advanced configuration</li>
							<li>Actuator</li>
							<li>A lot more...</li>
							<li>Resources</li>
						</ol>
					</section>
					<section>
						<h2>5.1 Overview</h2>
						<p align="left">Spring Boot represents a new development model on top of Spring framework. It introduces these main features:
							<ul>
								<li><strong>Starters</strong> - common groups of dependencies (e.g. web, JMS, remoting, etc.)</li>
								<li><strong>Autoconfiguration</strong> - autoconfiguration with default behaviour defined simply by annotations</li>
								<li><strong>Command-line interface (CLI)</strong> - run groovy scripts (as Spring application) simply as CLI</li>
								<li><strong>Actuator</strong> - common management features (healthcheck, basic information, metrics, etc.)</li>
							</ul>
						</p>
					</section>
					<section>
						<h2>5.2 Usage</h2>
						<p align="left">Declare parent POM (from Spring Boot):</p>
						<pre><code class="xml">&lt;parent&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
    &lt;version&gt;1.1.8.RELEASE&lt;/version&gt;
    &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;
&lt;/parent&gt;</code></pre>
						<p align="left">Define desired dependencies:</p>
						<pre><code class="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-data-rest&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
						<small align="left">Note: there's a lot of other available modules/dependencies (e.g. web, jpa, ws, batch, integration, actuator, mobile, etc.).</small>
					</section>
					<section>
						<h2>5.3 REST simple example</h2>
						<p align="left">Spring Boot simple/basic configuration:</p>
						<pre><code class="java">@Configuration
@ComponentScan(basePackages = "com.asseco.aha.training.spring_advanced.sb")
@EnableAutoConfiguration
public class SpringBootApplication {

    public static void main(String[] args) {
        SpringApplication.run(SpringBootApplication.class, args);
    }
}</code></pre>
						<p align="left">Simple REST implementation:</p>
						<pre><code class="java">@RestController
public class HelloController {

    @Value("${hello.name:Arny}")
    private String name;

    @RequestMapping("/hello")
    String hello() {
        return String.format("Hello %s!", name);
    }
}</code></pre>
						<aside class="notes">
							<p>
								<strong>rest</strong> - no XML-based, no required interface definition<br/>
								based on HTTP methods GET/PUT (update)/POST (insert)/DELETE<br/>
								stateless, cacheable, etc.
							</p>
						</aside>
					</section>
					<section>
						<h2>5.4 Externalize configuration [1/3]</h2>
						<h3>Priorities of external configuration</h3>
						<ul>
							<li>Command line arguments</li>
							<li>Java System properties (<i>System.getProperties()</i>). </li>
							<li>OS environment variables</li>
							<li>JNDI attributes from <i>java:comp/env</i></li>
							<li>A RandomValuePropertySource that only has properties in random.*</li>
							<li>Application properties outside of your packaged jar</li>
							<li>Application properties packaged inside your jar</li>
							<li>@PropertySource annotations on your <i>@Configuration</i> classes</li>
							<li>Default properties (specified using <i>SpringApplication.setDefaultProperties</i>)</li>
						</ul>
					</section>
					<section>
						<h2>5.4 Externalize configuration [2/3]</h2>
						<h3>Options to change configuration [1/2]</h3>
						<p align="left">Default configuration:</p>
						<pre><code class="java">java -jar spring-advanced-training.jar</code></pre>
						<p align="left">Command line argument configuration:</p>
						<pre><code class="java">java -jar spring-advanced-training.jar --hello.name=Richard</code></pre>
						<p align="left">Configuration by system property:</p>
						<pre><code class="java">java -Dhello.name="Sarah" -jar spring-advanced-training.jar</code></pre>
						<p align="left">Configuration by OS variable:</p>
						<pre><code class="java">set HELLO_NAME=Samuel
java -jar spring-advanced-training.jar</code></pre>						
						<aside class="notes">
							<p>
								Source: http://altfatterz.blogspot.cz/2014/10/software-configuration-with-spring-boot.html
								or http://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html
							</p>
						</aside>
					</section>
					<section>
						<h2>5.4 Externalize configuration [3/3]</h2>
						<h3>Options to change configuration [2/2]</h3>
						<p align="left">Configuration name:</p>
						<pre><code class="java">java -jar spring-advanced-training.jar --spring.config.name=config</code></pre>
						<p align="left">Configuration profile:</p>
						<pre><code class="java">// via command line argument
java -jar spring-advanced-training.jar --spring.profiles.active=xyz</code></pre>
						<p align="left">or</p>
						<pre><code class="java">// via JVM variable
java -Dspring.profiles.active=xyz -jar spring-advanced-training.jar</code></pre>
						<p align="left">Hard-coded by annotation @PropertySource:</p>
						<pre><code class="java">@Configuration
@PropertySource("file:D:/some path/custom_config.properties")
...
public class ConfigServiceApplication {
  ...
}</code></pre>
						<small>Not applicable to YAML files (only for properties files).</small>
					</section>
					<section>
						<h2>5.5 Random configuration</h2>
						<p align="left">The <i>RandomValuePropertySource</i> is class  for injecting random values (e.g. String, integers and long). 
						It's useful for testing. Example configuration is:</p>
						<pre><code class="java">my.value=${random.value}
my.number=${random.int}
my.bignumber=${random.long}
my.number.less.than.ten=${random.int(10)}
my.number.in.range=${random.int[1024,65536]}</code></pre>
						<small>Source: <a href="http://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html" alt="Source link">http://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html</a></small>
					</section>
					<section>
						<h2>5.6 YAML configuration</h2>
						<ul>
							<li>new hierarchical configuration approach</li>
							<li>discoverable as properties files (by <i>YamlPropertiesFactoryBean </i> and  <i>YamlMapFactoryBean </i>)</li>
							<li>YML file can not use tabulators (just spaces)</li>
						</ul>
						<p align="left">YML file:</p>
						<pre><code class="java">yaml:
    foo:
        value: Yaml foo value
        name: Bruno
    desc: Sample YAML configuration</code></pre>
						<p align="left">Available in runtime as:</p>
						<pre><code class="java">yaml.foo.value=Yaml foo value
yaml.foo.name=Bruno
yaml.desc=Sample YAML configuration</code></pre>
						<small>Source: <a href="http://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html" alt="Source link">http://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html</a></small>
					</section>
					<section>
						<h2>5.7 Actuator</h2>
						<p align="left">Actuator is Spring Boot extension to add management endpoints to the application.</p>
						<ol>
							<li><i>/beans</i> - the list of available/configured bean</li>
							<li><i>/env</i> - environment properties</li>
							<li><i>/dump</i> - the list of application threads with their stack trace</li>
							<li><i>/health</i> - displays the current application health</li>
							<li><i>/info</i> - displays application-specific information (<span style="color:red">TODO - example of adding info from manifest</span>)</li>
							<li><i>/metrics</i> - the list of application metrics</li>
							<li>Expose custom endpoint - see example <a href="http://www.javacodegeeks.com/2014/10/spring-boot-actuator-custom-endpoint-with-mvc-layer-on-top-of-it.html" alt="Example of Actuator custom endpoint implementation">here</a></li>
						</ol>
					</section>
					<section>
						<h2>5.8 A lot more...</h2>
						<p align="left">Spring Boot offers more features, e.g.:</p>
						<ol>
							<li>CLI - command line program invoker (based on Groovy)</li>
							<li>Cloud features
								<ul>
									<li>Eureka - handles service registration and discovery of services in a cluster (for resilient mid-tier load balancing and failover)</li>
									<li>Hystrix - is a latency and fault tolerance library (to isolate points of access to remote systems, services and 3rd party libraries, stop cascading failure, etc.)</li>
									<li>Zuul - is just a proxy to other services (dynamic routing, monitoring, resiliency, security, etc.)</li>
									<li>Config server - load external configuration (e.g. from GIT)</li>
									<li>@RefreshScope (part of confgi server) - refresh beans by calling localhost:8080/refresh</li>
								</ul>
							</li>
						</ol>
					</section>
					<section>
						<h2>5.9 Resources</h2>
						<ul>
							<li><a href="https://www.youtube.com/watch?v=VPtlZLdm7Nc" alt="Webinar on YouTube">Webinar: Building "Bootiful" Microservices with Spring Boot </a></li>
							<li>Example <a href="https://github.com/joshlong/spring-doge-microservice" alt="Example project spring-doge-microservice">spring-doge-microservice</a></li>
							<li>Example of <a href="http://www.justinleegrant.com/?p=489" alt="Example of usage of Mongo DB">usage of Mongo DB</a></li>
							<li><a href="https://looksok.wordpress.com/2014/11/22/spring-boot-sslhttps-for-embedded-tomcat/" alt="Guide to setup HTTPS for embedded Tomcat">HTTPS for embedded Tomcat</a></li>
							<li><a href="https://spring.io/blog/2014/11/23/bootiful-java-ee-support-in-spring-boot-1-2" alt="Guide to setup HTTPS for embedded Tomcat">"Bootiful" Java EE Support in Spring Boot 1.2</a></li>
						</ul>
					</section>
				</section>
				
				<section>
					<h2>6. Validation</h2>
					<p style="color:red">TODO</p>
					<ol>
						<li>JSR-303 - spring integration</li>
						<li>Valang (from Spring modules) - probably not</li>
						<li>JSR-303/JSR-349 Bean Validation - http://docs.spring.io/spring/docs/4.1.x/spring-framework-reference/html/validation.html</li>
						<li>aaa</li>
					</ol>
				</section>

				<section>
					<h2>7. Persistence</h2>
					<p style="color:red">TODO -  (JDBC/JPA/JTA and transaction)</p>
					<ol>
						<li>Spring @Transactional explained - http://doanduyhai.wordpress.com/2011/11/20/spring-transactional-explained/</li>
						<li>Spring @PersistenceContext/@PersistenceUnit explained - http://doanduyhai.wordpress.com/2011/11/21/spring-persistencecontext-explained/</li>
						<li>aaa</li>
						<li>aaa</li>
					</ol>
				</section>

				<section>
					<h2>8. AOP</h2>
					<p style="color:red">TODO</p>
					<ol>
						<li>Tangling & scattering (DevDay presentation?)</li>
						<li>aaa</li>
						<li>aaa</li>
						<li>aaa</li>
					</ol>
				</section>

				<section>
					<h2>9. Remoting & WS</h2>
					<p style="color:red">TODO</p>
					<ol>
						<li>Overview</li>
						<li>Spring HTTP Invoker</li>
						<li>JAX-WS</li>
					</ol>
					<aside class="notes">
						<p>Spring documentation - http://docs.spring.io/spring-framework/docs/current/spring-framework-reference/html/remoting.html</p>
					</aside>
				</section>

				<section>
					<h2>10. JMX</h2>
					<p style="color:red">TODO</p>
					<ol>
						<li>Jolokia (expose JMX over HTTP) - http://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-jmx.html</li>
						<li>aaa</li>
						<li>aaa</li>
						<li>aaa</li>
					</ol>
				</section>

				<section>
					<h1>THE END</h1>
					<h3>Thank you!</h3>
				</section>

			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>

	</body>
</html>
